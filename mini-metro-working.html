<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Metro</title>
    <link rel="stylesheet" href="mini-metro-enhanced.css">
    <style>
        /* Fix for world map display */
        .world-map-container {
            flex: 1;
            background: #F8FAFB;
            border-radius: 16px;
            padding: 20px;
            position: relative;
            overflow: auto;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        
        .world-map-svg {
            width: 100%;
            height: 100%;
            min-width: 800px;
            min-height: 400px;
        }
        
        .country-path {
            fill: #E8EEF5;
            stroke: #CBD5E1;
            stroke-width: 0.5;
            transition: fill 0.3s ease;
        }
        
        .country-path:hover {
            fill: #D4E6F1;
        }
        
        .city-marker-group {
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .city-marker-group:hover {
            transform: scale(1.2);
        }
        
        .city-dot {
            fill: #DD2515;
            stroke: #FFFFFF;
            stroke-width: 2;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .city-dot.locked {
            fill: #94A3B8;
        }
        
        .city-dot.completed {
            fill: #35AB52;
        }
        
        .city-label {
            font-size: 11px;
            fill: #0F172A;
            text-anchor: middle;
            font-weight: 600;
            pointer-events: none;
        }
        
        .city-connection {
            stroke: #2581C4;
            stroke-width: 2;
            stroke-dasharray: 5, 5;
            fill: none;
            opacity: 0.3;
            animation: dashMove 20s linear infinite;
        }
        
        @keyframes dashMove {
            to { stroke-dashoffset: -100; }
        }
        
        /* Fix game canvas display */
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 100;
            background: #F5F5F5;
        }
        
        #game-ui {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 101;
            padding: 20px;
            pointer-events: none;
        }
        
        #game-ui > * {
            pointer-events: auto;
        }
        
        .game-menu-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #333;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Helvetica Neue', sans-serif;
        }
        
        .game-menu-btn:hover {
            background: #333;
            color: white;
            transform: translateY(-2px);
        }
        
        /* Debug info */
        .debug-info {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            z-index: 10000;
            display: none;
        }
        
        .debug-info.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-animation">
            <div class="metro-line line-1"></div>
            <div class="metro-line line-2"></div>
            <div class="metro-line line-3"></div>
            <div class="station-dot dot-1"></div>
            <div class="station-dot dot-2"></div>
            <div class="station-dot dot-3"></div>
        </div>
        <div class="loading-text">LOADING</div>
    </div>

    <!-- Main Menu -->
    <div id="main-menu" class="screen active">
        <div class="menu-container">
            <div class="logo-section">
                <h1 class="game-logo">
                    <span class="logo-mini">MINI</span>
                    <span class="logo-metro">METRO</span>
                </h1>
                <div class="logo-underline"></div>
                <p class="game-tagline">Mind the Gap</p>
            </div>
            
            <nav class="menu-nav">
                <button class="menu-item" id="play-btn">
                    <span class="menu-icon">‚ñ∂</span>
                    <span class="menu-text">PLAY</span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                <button class="menu-item daily" id="daily-btn">
                    <span class="menu-icon">üìÖ</span>
                    <span class="menu-text">DAILY CHALLENGE</span>
                    <span class="menu-badge">NEW</span>
                </button>
                <button class="menu-item" id="achievements-btn">
                    <span class="menu-icon">üèÜ</span>
                    <span class="menu-text">ACHIEVEMENTS</span>
                    <span class="menu-progress">67%</span>
                </button>
                <button class="menu-item" id="leaderboard-btn">
                    <span class="menu-icon">üìä</span>
                    <span class="menu-text">LEADERBOARD</span>
                    <span class="menu-rank">#142</span>
                </button>
                <button class="menu-item" id="settings-btn">
                    <span class="menu-icon">‚öô</span>
                    <span class="menu-text">SETTINGS</span>
                </button>
            </nav>
        </div>
    </div>

    <!-- City Selection -->
    <div id="city-select" class="screen">
        <header class="screen-header">
            <button class="back-btn" id="city-back-btn">
                <span class="back-icon">‚Üê</span>
                <span class="back-text">BACK</span>
            </button>
            <div class="header-info">
                <h2 class="screen-title">SELECT DESTINATION</h2>
                <div class="unlock-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 35%"></div>
                    </div>
                    <span class="progress-text" id="progress-text">12 of 34 Cities Unlocked</span>
                </div>
            </div>
            <div class="view-toggle">
                <button class="view-btn active" id="view-map-btn">üó∫ Map</button>
                <button class="view-btn" id="view-grid-btn">‚äû Grid</button>
            </div>
        </header>

        <!-- World Map View -->
        <div id="world-map-view" class="city-view active">
            <div class="world-map-container">
                <svg id="world-map-svg" class="world-map-svg" viewBox="-50 -50 1300 700">
                    <!-- Simple world continents -->
                    <g id="continents">
                        <!-- Europe -->
                        <path class="country-path" d="M550,200 L600,180 L650,190 L680,220 L650,250 L600,240 L550,230 Z" />
                        <!-- North America -->
                        <path class="country-path" d="M200,180 L350,150 L380,200 L350,280 L250,300 L180,250 L200,180 Z" />
                        <!-- Asia -->
                        <path class="country-path" d="M700,150 L850,140 L900,200 L880,280 L750,290 L700,240 L700,150 Z" />
                        <!-- South America -->
                        <path class="country-path" d="M280,350 L320,340 L350,400 L340,480 L300,490 L270,450 L280,350 Z" />
                        <!-- Africa -->
                        <path class="country-path" d="M550,280 L600,270 L620,350 L600,420 L560,430 L540,380 L550,280 Z" />
                        <!-- Oceania -->
                        <path class="country-path" d="M850,400 L900,390 L920,420 L900,450 L860,460 L840,430 L850,400 Z" />
                    </g>
                    
                    <!-- City connections will be drawn here -->
                    <g id="connections"></g>
                    
                    <!-- City markers will be drawn here -->
                    <g id="city-markers"></g>
                </svg>
            </div>
            
            <!-- City Detail Panel -->
            <div id="city-detail" class="city-detail-panel">
                <div class="city-detail-header">
                    <h3 class="city-name" id="detail-city-name">SELECT A CITY</h3>
                    <span class="city-difficulty" id="detail-difficulty">‚óè‚óè‚óè‚óã‚óã</span>
                </div>
                <div class="city-preview">
                    <canvas id="city-preview-canvas" width="300" height="150"></canvas>
                </div>
                <div class="city-stats">
                    <div class="stat-item">
                        <span class="stat-label">TARGET</span>
                        <span class="stat-value" id="stat-target">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">HIGHSCORE</span>
                        <span class="stat-value" id="stat-highscore">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">WORLD RANK</span>
                        <span class="stat-value" id="stat-rank">-</span>
                    </div>
                </div>
                <button class="play-city-btn" id="play-city-btn" disabled>SELECT CITY FIRST</button>
            </div>
        </div>

        <!-- Grid View -->
        <div id="grid-view" class="city-view">
            <div class="cities-grid" id="cities-grid"></div>
        </div>
    </div>

    <!-- Mode Selection -->
    <div id="mode-select" class="screen">
        <header class="screen-header">
            <button class="back-btn" id="mode-back-btn">
                <span class="back-icon">‚Üê</span>
                <span class="back-text">BACK</span>
            </button>
            <div class="selected-city-info">
                <h2 id="selected-city-title">LONDON</h2>
                <p id="selected-city-desc">Cross the Thames</p>
            </div>
        </header>

        <div class="modes-container">
            <div class="mode-card" data-mode="normal">
                <div class="mode-icon">üéØ</div>
                <h3 class="mode-name">NORMAL</h3>
                <p class="mode-description">Build an efficient network for a rapidly growing city</p>
                <button class="select-mode-btn" data-mode="normal">PLAY NORMAL</button>
            </div>

            <div class="mode-card" data-mode="endless">
                <div class="mode-icon">‚àû</div>
                <h3 class="mode-name">ENDLESS</h3>
                <p class="mode-description">Relax and build without pressure</p>
                <button class="select-mode-btn" data-mode="endless">PLAY ENDLESS</button>
            </div>

            <div class="mode-card locked" data-mode="extreme">
                <div class="mode-icon">‚ö°</div>
                <h3 class="mode-name">EXTREME</h3>
                <p class="mode-description">No modifications allowed</p>
                <button class="select-mode-btn" data-mode="extreme" disabled>LOCKED</button>
            </div>

            <div class="mode-card locked" data-mode="creative">
                <div class="mode-icon">üé®</div>
                <h3 class="mode-name">CREATIVE</h3>
                <p class="mode-description">Design your dream network</p>
                <button class="select-mode-btn" data-mode="creative" disabled>LOCKED</button>
            </div>
        </div>
    </div>

    <!-- Game Canvas -->
    <canvas id="gameCanvas" style="display: none;"></canvas>
    
    <!-- Game UI Overlay -->
    <div id="game-ui" style="display: none;">
        <button class="game-menu-btn" id="exit-game-btn">‚Üê MENU</button>
    </div>

    <!-- Debug Info -->
    <div class="debug-info" id="debug-info"></div>

    <!-- Scripts -->
    <script src="city-maps.js"></script>
    <script src="game-realistic.js"></script>
    <script>
        // Enhanced Mini Metro UI - WORKING VERSION
        class MiniMetroApp {
            constructor() {
                this.currentScreen = 'main-menu';
                this.selectedCity = null;
                this.selectedMode = 'normal';
                this.currentView = 'map';
                
                this.cities = [
                    { id: 'london', name: 'LONDON', x: 600, y: 200, unlocked: true, target: 750, highscore: 0, stars: 0, difficulty: 3 },
                    { id: 'paris', name: 'PARIS', x: 580, y: 220, unlocked: true, target: 750, highscore: 0, stars: 0, difficulty: 3 },
                    { id: 'newyork', name: 'NEW YORK', x: 280, y: 230, unlocked: true, target: 750, highscore: 0, stars: 0, difficulty: 4 },
                    { id: 'berlin', name: 'BERLIN', x: 620, y: 190, unlocked: false, target: 750, requires: 'london', highscore: 0, stars: 0, difficulty: 4 },
                    { id: 'tokyo', name: 'TOKYO', x: 860, y: 250, unlocked: false, target: 900, requires: 'paris', highscore: 0, stars: 0, difficulty: 5 },
                    { id: 'hongkong', name: 'HONG KONG', x: 820, y: 280, unlocked: false, target: 900, requires: 'newyork', highscore: 0, stars: 0, difficulty: 4 },
                    { id: 'sydney', name: 'SYDNEY', x: 880, y: 440, unlocked: false, target: 1000, requires: 'berlin', highscore: 0, stars: 0, difficulty: 4 },
                    { id: 'moscow', name: 'MOSCOW', x: 680, y: 160, unlocked: false, target: 1000, requires: 'tokyo', highscore: 0, stars: 0, difficulty: 3 },
                    { id: 'cairo', name: 'CAIRO', x: 580, y: 320, unlocked: false, target: 1100, requires: 'hongkong', highscore: 0, stars: 0, difficulty: 3 },
                    { id: 'singapore', name: 'SINGAPORE', x: 800, y: 380, unlocked: false, target: 1200, requires: 'sydney', highscore: 0, stars: 0, difficulty: 4 },
                ];
                
                this.init();
            }
            
            init() {
                console.log('Initializing Mini Metro App...');
                this.setupEventListeners();
                this.loadProgress();
                this.drawWorldMap();
                this.hideLoadingScreen();
            }
            
            setupEventListeners() {
                // Main menu buttons
                document.getElementById('play-btn').addEventListener('click', () => this.showCitySelect());
                document.getElementById('daily-btn').addEventListener('click', () => this.startDailyChallenge());
                document.getElementById('achievements-btn').addEventListener('click', () => alert('Achievements coming soon!'));
                document.getElementById('leaderboard-btn').addEventListener('click', () => alert('Leaderboard coming soon!'));
                document.getElementById('settings-btn').addEventListener('click', () => alert('Settings coming soon!'));
                
                // Navigation
                document.getElementById('city-back-btn').addEventListener('click', () => this.showMainMenu());
                document.getElementById('mode-back-btn').addEventListener('click', () => this.showCitySelect());
                document.getElementById('exit-game-btn').addEventListener('click', () => this.exitGame());
                
                // View toggle
                document.getElementById('view-map-btn').addEventListener('click', () => this.setView('map'));
                document.getElementById('view-grid-btn').addEventListener('click', () => this.setView('grid'));
                
                // Play city button
                document.getElementById('play-city-btn').addEventListener('click', () => this.proceedToModeSelect());
                
                // Mode selection buttons
                document.querySelectorAll('.select-mode-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const mode = e.target.dataset.mode;
                        if (!e.target.disabled) {
                            this.launchGame(mode);
                        }
                    });
                });
                
                // Debug key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'd' && e.ctrlKey) {
                        document.getElementById('debug-info').classList.toggle('show');
                        this.updateDebugInfo();
                    }
                });
            }
            
            hideLoadingScreen() {
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 300);
                }, 1500);
            }
            
            drawWorldMap() {
                console.log('Drawing world map...');
                const svg = document.getElementById('world-map-svg');
                const connectionsGroup = document.getElementById('connections');
                const markersGroup = document.getElementById('city-markers');
                
                // Clear existing
                connectionsGroup.innerHTML = '';
                markersGroup.innerHTML = '';
                
                // Draw connections between unlocked cities
                this.cities.forEach(city => {
                    if (city.unlocked && city.requires) {
                        const fromCity = this.cities.find(c => c.id === city.requires);
                        if (fromCity && fromCity.unlocked) {
                            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                            line.classList.add('city-connection');
                            line.setAttribute('x1', fromCity.x);
                            line.setAttribute('y1', fromCity.y);
                            line.setAttribute('x2', city.x);
                            line.setAttribute('y2', city.y);
                            connectionsGroup.appendChild(line);
                        }
                    }
                });
                
                // Draw city markers
                this.cities.forEach(city => {
                    const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    g.classList.add('city-marker-group');
                    
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.classList.add('city-dot');
                    if (!city.unlocked) circle.classList.add('locked');
                    if (city.highscore >= city.target) circle.classList.add('completed');
                    circle.setAttribute('cx', city.x);
                    circle.setAttribute('cy', city.y);
                    circle.setAttribute('r', 8);
                    
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.classList.add('city-label');
                    text.setAttribute('x', city.x);
                    text.setAttribute('y', city.y + 25);
                    text.textContent = city.name.substring(0, 3);
                    
                    g.appendChild(circle);
                    g.appendChild(text);
                    
                    if (city.unlocked) {
                        g.style.cursor = 'pointer';
                        g.addEventListener('click', () => this.selectCityFromMap(city));
                        g.addEventListener('mouseenter', () => this.previewCity(city));
                    }
                    
                    markersGroup.appendChild(g);
                });
            }
            
            selectCityFromMap(city) {
                console.log('Selected city:', city.name);
                this.selectedCity = city;
                this.updateCityDetailPanel(city);
            }
            
            previewCity(city) {
                // Draw river preview on canvas
                const canvas = document.getElementById('city-preview-canvas');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                ctx.strokeStyle = '#D4E6F1';
                ctx.lineWidth = 8;
                ctx.lineCap = 'round';
                
                // Simple river based on city
                ctx.beginPath();
                if (city.id === 'london') {
                    ctx.moveTo(0, 75);
                    ctx.bezierCurveTo(100, 50, 200, 100, 300, 75);
                } else if (city.id === 'paris') {
                    ctx.moveTo(0, 75);
                    ctx.quadraticCurveTo(150, 50, 300, 75);
                } else if (city.id === 'newyork') {
                    ctx.moveTo(100, 0);
                    ctx.lineTo(100, 150);
                    ctx.moveTo(200, 0);
                    ctx.lineTo(200, 150);
                } else {
                    ctx.moveTo(0, 75);
                    ctx.lineTo(300, 75);
                }
                ctx.stroke();
            }
            
            updateCityDetailPanel(city) {
                document.getElementById('detail-city-name').textContent = city.name;
                
                const difficultyDots = Array(5).fill('').map((_, i) => 
                    i < city.difficulty ? '‚óè' : '‚óã'
                ).join('');
                document.getElementById('detail-difficulty').textContent = difficultyDots;
                
                document.getElementById('stat-target').textContent = city.target;
                document.getElementById('stat-highscore').textContent = city.highscore || '-';
                document.getElementById('stat-rank').textContent = city.highscore ? '#' + Math.floor(Math.random() * 1000 + 100) : '-';
                
                const playBtn = document.getElementById('play-city-btn');
                if (city.unlocked) {
                    playBtn.disabled = false;
                    playBtn.textContent = `PLAY ${city.name}`;
                } else {
                    playBtn.disabled = true;
                    playBtn.textContent = 'CITY LOCKED';
                }
                
                this.previewCity(city);
            }
            
            renderCityGrid() {
                const grid = document.getElementById('cities-grid');
                grid.innerHTML = '';
                
                this.cities.forEach(city => {
                    const card = document.createElement('div');
                    card.className = 'city-card';
                    if (!city.unlocked) card.classList.add('locked');
                    
                    const stars = Array(3).fill('').map((_, i) => 
                        `<span class="star ${i < city.stars ? '' : 'empty'}">‚òÖ</span>`
                    ).join('');
                    
                    card.innerHTML = `
                        <div class="city-card-name">${city.name}</div>
                        <div class="city-card-preview"></div>
                        <div class="city-card-stats">
                            <span class="city-card-target">üéØ ${city.target}</span>
                            <span class="city-card-highscore">üèÜ ${city.highscore || '-'}</span>
                        </div>
                        <div class="city-card-stars">${stars}</div>
                    `;
                    
                    if (city.unlocked) {
                        card.addEventListener('click', () => {
                            this.selectedCity = city;
                            this.proceedToModeSelect();
                        });
                    }
                    
                    grid.appendChild(card);
                });
            }
            
            proceedToModeSelect() {
                if (!this.selectedCity) return;
                
                document.getElementById('selected-city-title').textContent = this.selectedCity.name;
                document.getElementById('selected-city-desc').textContent = this.getCityDescription(this.selectedCity);
                
                this.showScreen('mode-select');
            }
            
            getCityDescription(city) {
                const descriptions = {
                    london: 'Cross the Thames and connect historic London',
                    paris: 'Navigate the Seine and its romantic islands',
                    newyork: 'Bridge the rivers to unite the five boroughs',
                    berlin: 'Limited bridges challenge your planning',
                    tokyo: 'Master the world\'s busiest metro system'
                };
                return descriptions[city.id] || 'Build an efficient metro network';
            }
            
            launchGame(mode) {
                console.log(`Launching game: ${this.selectedCity.name} - ${mode}`);
                
                this.selectedMode = mode;
                
                // Hide all screens
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                
                // Show game canvas
                document.getElementById('gameCanvas').style.display = 'block';
                document.getElementById('game-ui').style.display = 'block';
                
                // Initialize game
                try {
                    if (typeof MiniMetro !== 'undefined') {
                        if (!window.game) {
                            window.game = new MiniMetro();
                        }
                        
                        // Initialize with selected city
                        window.game.currentCity = this.selectedCity.id;
                        window.game.currentMode = mode;
                        window.game.restart();
                        
                        console.log('Game started successfully!');
                    } else {
                        console.error('MiniMetro class not found!');
                        alert('Game engine not loaded. Please refresh the page.');
                    }
                } catch (error) {
                    console.error('Error starting game:', error);
                    alert('Error starting game. Check console for details.');
                }
                
                this.updateDebugInfo();
            }
            
            startDailyChallenge() {
                this.selectedCity = this.cities[0]; // London
                this.launchGame('daily');
            }
            
            exitGame() {
                // Hide game
                document.getElementById('gameCanvas').style.display = 'none';
                document.getElementById('game-ui').style.display = 'none';
                
                // Pause game
                if (window.game) {
                    window.game.paused = true;
                }
                
                // Return to main menu
                this.showMainMenu();
            }
            
            setView(view) {
                this.currentView = view;
                
                document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(`view-${view}-btn`).classList.add('active');
                
                document.querySelectorAll('.city-view').forEach(v => v.classList.remove('active'));
                
                if (view === 'map') {
                    document.getElementById('world-map-view').classList.add('active');
                } else {
                    document.getElementById('grid-view').classList.add('active');
                    this.renderCityGrid();
                }
            }
            
            showScreen(screenId) {
                console.log('Showing screen:', screenId);
                
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                
                const screen = document.getElementById(screenId);
                if (screen) {
                    screen.classList.add('active');
                    this.currentScreen = screenId;
                }
                
                this.updateDebugInfo();
            }
            
            showMainMenu() {
                this.showScreen('main-menu');
            }
            
            showCitySelect() {
                this.showScreen('city-select');
            }
            
            loadProgress() {
                const saved = localStorage.getItem('miniMetroProgress');
                if (saved) {
                    try {
                        const progress = JSON.parse(saved);
                        this.cities.forEach(city => {
                            if (progress[city.id]) {
                                Object.assign(city, progress[city.id]);
                            }
                        });
                    } catch (e) {
                        console.error('Failed to load progress:', e);
                    }
                }
                
                this.updateProgressDisplay();
            }
            
            saveProgress() {
                const progress = {};
                this.cities.forEach(city => {
                    progress[city.id] = {
                        unlocked: city.unlocked,
                        highscore: city.highscore,
                        stars: city.stars
                    };
                });
                localStorage.setItem('miniMetroProgress', JSON.stringify(progress));
            }
            
            updateProgressDisplay() {
                const unlocked = this.cities.filter(c => c.unlocked).length;
                const total = this.cities.length;
                
                document.getElementById('progress-fill').style.width = `${(unlocked / total) * 100}%`;
                document.getElementById('progress-text').textContent = `${unlocked} of ${total} Cities Unlocked`;
            }
            
            updateDebugInfo() {
                const debug = document.getElementById('debug-info');
                debug.innerHTML = `
                    Screen: ${this.currentScreen}<br>
                    City: ${this.selectedCity?.name || 'none'}<br>
                    Mode: ${this.selectedMode}<br>
                    Game: ${window.game ? 'loaded' : 'not loaded'}<br>
                    Cities: ${this.cities.filter(c => c.unlocked).length}/${this.cities.length}
                `;
            }
        }
        
        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing app...');
            window.app = new MiniMetroApp();
        });
    </script>
</body>
</html>